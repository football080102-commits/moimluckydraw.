<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium Lucky Draw v2</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-blue: #00d2ff;
            --deep-blue: #0045ff;
            --dark-bg: #030816;
        }

        body {
            background-color: var(--dark-bg);
            background-image: radial-gradient(circle at center, #0a1931 0%, #030816 100%);
            color: white;
            font-family: 'Pretendard', sans-serif;
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }

        /* ìƒë‹¨ ë ˆì´ì•„ì›ƒ */
        .top-ui {
            position: absolute;
            top: 30px;
            width: 90%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .btn-sub {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #aaa;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
        }

        /* ë©”ì¸ ìƒì ë°°ì¹˜ (ì¤‘ì•™ë³´ë‹¤ ì•½ê°„ ìœ„) */
        #main-stage {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center; /* ì¤‘ì•™ ë°°ì¹˜ í›„ marginìœ¼ë¡œ ì¡°ì ˆ */
            align-items: center;
            width: 100%;
            margin-top: -50px; 
        }

        #box-container {
            position: relative;
            margin-bottom: 40px;
        }

        #box {
            font-size: 180px; /* í¬ê¸° í‚¤ì›€ */
            filter: drop-shadow(0 0 30px var(--deep-blue));
            cursor: pointer;
            transition: all 1.5s cubic-bezier(0.19, 1, 0.22, 1);
        }

        /* ë‹¨ê³„ë³„ í…ìŠ¤íŠ¸ ì• ë‹ˆë©”ì´ì…˜ (ìŠ¬ë¡œìš°) */
        #popup-text {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 90px;
            font-weight: 900;
            color: var(--primary-blue);
            text-shadow: 0 0 20px var(--deep-blue), 0 0 40px white;
            opacity: 0;
            pointer-events: none;
        }

        /* ë¶„ìœ„ê¸° ë°˜ì „ìš© ì˜¤ë²„ë ˆì´ (ë¶€ë¶„ ì•”ì „/ëª…ì „) */
        #ambience {
            position: fixed;
            top:0; left:0; width:100%; height:100%;
            background: white;
            opacity: 0;
            pointer-events: none;
            z-index: 999;
            transition: opacity 0.8s ease;
        }

        /* ê²°ê³¼ ì¹´ë“œ ë””ìì¸ */
        #result-card {
            display: none;
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 350px;
            height: 500px;
            background: linear-gradient(145deg, #001f4d, #000);
            border: 3px solid var(--primary-blue);
            border-radius: 30px;
            box-shadow: 0 0 100px rgba(0, 210, 255, 0.4);
            z-index: 1000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            animation: cardEmerge 1.2s ease-out;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ ì •ì˜ */
        @keyframes cardEmerge {
            0% { transform: translate(-50%, -50%) scale(0.5) rotateY(90deg); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1) rotateY(0deg); opacity: 1; }
        }

        @keyframes slowUp {
            0% { transform: translate(-50%, 50%); opacity: 0; filter: blur(10px); }
            30% { transform: translate(-50%, -50%); opacity: 1; filter: blur(0); }
            70% { transform: translate(-50%, -50%); opacity: 1; }
            100% { transform: translate(-50%, -150%); opacity: 0; }
        }

        .open-btn {
            background: linear-gradient(to right, #0052ff, #00d2ff);
            border: none;
            padding: 20px 80px;
            font-size: 28px;
            font-weight: bold;
            border-radius: 100px;
            color: white;
            box-shadow: 0 10px 30px rgba(0, 82, 255, 0.4);
            cursor: pointer;
            transition: transform 0.2s;
        }

        /* í¬í† ë¶€ìŠ¤ */
        #photo-booth {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 2000;
        }
        .photo-slot { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; border-right: 1px solid #111; }
    </style>
</head>
<body>

<div id="ambience"></div>

<div class="top-ui">
    <button class="btn-sub" onclick="resetData()">RESET</button>
    <div id="counter" style="color: var(--primary-blue); font-weight: bold;">ë‚¨ì€ ì¸ì›: 0ëª…</div>
    <button id="booth-btn" style="display:none; background: #00d2ff; color: #000; font-weight: bold; border:none; padding:10px 20px; border-radius:5px;" onclick="showPhotoBooth()">ğŸ“¸ PHOTO BOOTH</button>
</div>

<div id="main-stage">
    <div id="box-container">
        <div id="box" onclick="startDraw()">ğŸ</div>
        <div id="popup-text"></div>
    </div>
    <button class="open-btn" id="open-btn" onclick="startDraw()">OPEN PACK</button>

    <div id="result-card">
        <div id="res-unit" style="color: var(--primary-blue); font-size: 20px;"></div>
        <div id="res-grade" style="font-size: 28px; margin: 10px 0;"></div>
        <div id="res-name" style="font-size: 70px; font-weight: 900; text-shadow: 0 0 20px var(--primary-blue);"></div>
        <div style="margin-top: 40px; letter-spacing: 5px; color: #aaa;">CONGRATULATIONS</div>
        <button onclick="closeResult()" style="margin-top: 40px; background: none; border: 1px solid #555; color: #555;">NEXT DRAW</button>
    </div>
</div>

<div id="photo-booth" onclick="hidePhotoBooth()" style="display:none; flex-direction: row;">
    <div class="photo-slot" id="slot-0"></div>
    <div class="photo-slot" id="slot-1"></div>
    <div class="photo-slot" id="slot-2"></div>
</div>

<script>
    // JSON ë°ì´í„° (í•™ë…„ ë³€í™˜ ë¡œì§ í¬í•¨)
    const rawData = [
        { "grade": 6, "class": 1, "name": "ê¹€ì§€ì„±" }, { "grade": 4, "class": 1, "name": "ê¹€ìŠ¹í•˜" }, { "grade": 4, "class": 1, "name": "ê¹€ìœ í•˜" }, { "grade": 4, "class": 1, "name": "ë°•íš¨ì§„" },
        { "grade": 3, "class": 1, "name": "ê¹€ë‹¨ë¹„" }, { "grade": 3, "class": 1, "name": "ê¹€íƒœê±´" }, { "grade": 3, "class": 1, "name": "ì •ìœ¤ì„œ" }, { "grade": 2, "class": 1, "name": "ê¹€ìœ¤ì„œ" },
        { "grade": 2, "class": 1, "name": "ë°°ê²½ì€" }, { "grade": 2, "class": 1, "name": "ìµœì‹œì›" }, { "grade": 2, "class": 1, "name": "ì¥ë„ì›" }, { "grade": 1, "class": 1, "name": "ê¶Œí˜œì•„" },
        { "grade": 1, "class": 1, "name": "ìœ ì±„ìœ¤" }, { "grade": 1, "class": 1, "name": "ìœ¤ì†Œëª…" }, { "grade": 1, "class": 1, "name": "ì´ì§„ì„œ" }, { "grade": 1, "class": 1, "name": "ì„ì±„í•˜" },
        { "grade": 1, "class": 1, "name": "ì •ì§„ì£¼" }, { "grade": 6, "class": 2, "name": "ê¹€ì¬í˜•" }, { "grade": 4, "class": 2, "name": "ê°•íš¨ë¹ˆ" }, { "grade": 4, "class": 2, "name": "ë¬¸ìœ ê±´" },
        { "grade": 4, "class": 2, "name": "ìœ¤ì†Œí˜„" }, { "grade": 2, "class": 2, "name": "ê¹€ì„œì§„" }, { "grade": 2, "class": 2, "name": "ë°•ìœ ë¹ˆ" }, { "grade": 1, "class": 2, "name": "ê³µì˜ˆì€" },
        { "grade": 1, "class": 2, "name": "ë¬¸ìŠ¹ìœ¤" }, { "grade": 1, "class": 2, "name": "ì„±í•˜ì—°" }, { "grade": 6, "class": 3, "name": "ê¹€ì£¼ì˜" }, { "grade": 6, "class": 3, "name": "ì´ì¤€ì—°" },
        { "grade": 4, "class": 3, "name": "ê°•ë¯¼í˜" }, { "grade": 4, "class": 3, "name": "ê¶Œì¤€ì˜" }, { "grade": 4, "class": 3, "name": "ì„±í˜¸ì—°" }, { "grade": 4, "class": 3, "name": "ì •ì§„ì–‘" },
        { "grade": 3, "class": 3, "name": "ì—„ë‹¤ì• " }, { "grade": 3, "class": 3, "name": "ì´ì‹œí˜„" }, { "grade": 2, "class": 3, "name": "ë°°ìœ ì°¬" }, { "grade": 2, "class": 3, "name": "ì„œí•˜ë¦°" },
        { "grade": 2, "class": 3, "name": "ë°•í•˜ì§„" }, { "grade": 1, "class": 3, "name": "ê°•ìˆ˜ì˜" }, { "grade": 1, "class": 3, "name": "ê¶Œì„œìœ¤" }, { "grade": 1, "class": 3, "name": "ê¹€ì§€ë¯¼" },
        { "grade": 1, "class": 3, "name": "ì‹¬ë¯¼í•˜" }, { "grade": 1, "class": 3, "name": "í•˜ì˜ì§„" }, { "grade": 4, "class": 4, "name": "ë¬¸ì„±ì›" }, { "grade": 4, "class": 4, "name": "ì†ìŠ¹í˜„" },
        { "grade": 4, "class": 4, "name": "ì„íš¨ë¦°" }, { "grade": 3, "class": 4, "name": "ì–‘ìœ¤ìŠ¬" }, { "grade": 3, "class": 4, "name": "ì´ì„œë¦°" }, { "grade": 3, "class": 4, "name": "ì±„ì¤€í•˜" },
        { "grade": 2, "class": 4, "name": "ê¹€ìŠ¹ì£¼" }, { "grade": 2, "class": 4, "name": "ì •ì„¸ì–‘" }, { "grade": 2, "class": 4, "name": "ì‹ ì„œì•„" }, { "grade": 2, "class": 4, "name": "ì •ì‹œí™˜" },
        { "grade": 1, "class": 4, "name": "ê¶Œì˜ˆì€" }, { "grade": 1, "class": 4, "name": "ê¹€ê°€ì„" }, { "grade": 1, "class": 4, "name": "ì„œí•˜ì§„" }, { "grade": 1, "class": 4, "name": "ì†ì£¼ì€" },
        { "grade": 1, "class": 4, "name": "ì´ë¡œíœ˜" }
    ];

    let participants = [...rawData];
    let history = [];

    function getGradeName(g) {
        return g <= 3 ? `ì¤‘í•™êµ ${g}í•™ë…„` : `ê³ ë“±í•™êµ ${g-3}í•™ë…„`;
    }

    function updateCounter() {
        document.getElementById('counter').innerText = `READY: ${participants.length}`;
    }
    updateCounter();

    function startDraw() {
        if (participants.length === 0) return;
        
        const openBtn = document.getElementById('open-btn');
        openBtn.style.visibility = 'hidden';

        const winnerIdx = Math.floor(Math.random() * participants.length);
        const winner = participants.splice(winnerIdx, 1)[0];
        history.push(winner);
        updateCounter();

        const box = document.getElementById('box');
        const ambience = document.getElementById('ambience');

        // ì—°ì¶œ ì‹œì‘
        box.style.animation = "shake 0.3s infinite";
        
        // 1ë‹¨ê³„: ë¶„ì„ (2ì´ˆ ë’¤)
        setTimeout(() => showText(`${winner.class} ë¶„ì„`), 1000);
        
        // 2ë‹¨ê³„: í•™ë…„ (4ì´ˆ ë’¤ - ë” ëŠë¦¬ê²Œ)
        setTimeout(() => showText(getGradeName(winner.grade)), 3000);

        // 3ë‹¨ê³„: í”¼ë‚ ë ˆ ë¹Œë“œì—…
        setTimeout(() => {
            box.style.transform = "scale(4)";
            ambience.style.opacity = "0.7"; // í™”ë©´ì´ ì ì  ë°ì•„ì§
            
            setTimeout(() => {
                ambience.style.background = "white";
                ambience.style.opacity = "1"; // ìˆœê°„ ì„¬ê´‘
                
                setTimeout(() => {
                    ambience.style.opacity = "0";
                    box.style.opacity = "0";
                    showResultCard(winner);
                }, 400);
            }, 1500);
        }, 5000);
    }

    function showText(txt) {
        const el = document.getElementById('popup-text');
        el.innerText = txt;
        el.style.animation = 'none';
        void el.offsetWidth;
        el.style.animation = 'slowUp 2s forwards';
    }

    function showResultCard(winner) {
        const card = document.getElementById('result-card');
        document.getElementById('res-unit').innerText = `${winner.class} UNIT`;
        document.getElementById('res-grade').innerText = getGradeName(winner.grade);
        document.getElementById('res-name').innerText = winner.name;
        card.style.display = 'flex';

        confetti({
            particleCount: 200, spread: 100, origin: { y: 0.6 },
            colors: ['#00d2ff', '#0052ff', '#ffffff']
        });

        if (history.length % 3 === 0) {
            document.getElementById('booth-btn').style.display = 'block';
        }
    }

    function closeResult() {
        document.getElementById('result-card').style.display = 'none';
        document.getElementById('open-btn').style.visibility = 'visible';
        const box = document.getElementById('box');
        box.style.transform = "scale(1)";
        box.style.opacity = "1";
        box.style.animation = "none";
    }

    function showPhotoBooth() {
        const booth = document.getElementById('photo-booth');
        const last3 = history.slice(-3);
        last3.forEach((p, i) => {
            document.getElementById(`slot-${i}`).innerHTML = `
                <div style="color:#00d2ff; font-size:24px;">${getGradeName(p.grade)}</div>
                <div style="font-size:80px; font-weight:bold; margin:20px 0;">${p.name}</div>
                <div style="color:#555;">${p.class}ë¶„ì„</div>
            `;
        });
        booth.style.display = 'flex';
    }

    function hidePhotoBooth() {
        document.getElementById('photo-booth').style.display = 'none';
        document.getElementById('booth-btn').style.display = 'none';
    }

    function resetData() {
        if(confirm("ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í• ê¹Œìš”?")) {
            participants = [...rawData];
            history = [];
            updateCounter();
            location.reload();
        }
    }
</script>

</body>
</html>

ğŸ› ï¸ ë¬´ì—‡ì´ ë°”ë€Œì—ˆë‚˜ìš”?
 * ë°°ì¹˜ ë° í¬ê¸°: ìƒìê°€ í™”ë©´ ì¤‘ì•™ë³´ë‹¤ ì•½ê°„ ìœ„ë¡œ ì˜¬ë¼ê°”ìœ¼ë©°, ê¸°ë³¸ í¬ê¸°ê°€ ë” ì»¤ì¡ŒìŠµë‹ˆë‹¤.
 * ìŠ¬ë¡œìš° ì• ë‹ˆë©”ì´ì…˜: í…ìŠ¤íŠ¸ê°€ ëœ¨ëŠ” ê°„ê²©ì„ ëŠ˜ë ¸ê³ (1.5s -> 2s), ë§ˆì§€ë§‰ ìƒìê°€ ì»¤ì§€ëŠ” êµ¬ê°„ì„ 5ì´ˆ ë’¤ë¡œ ì„¤ì •í•˜ì—¬ "ëˆ„ê°€ ë‚˜ì˜¬ê¹Œ?" í•˜ëŠ” ê¸´ì¥ê°ì„ ë” ê¸¸ê²Œ ì¡ì•˜ìŠµë‹ˆë‹¤.
 * ì„¸ë ¨ëœ ì„¬ê´‘: ì „ì²´ í™”ë©´ì´ í™• ë°ì•„ì§€ê¸°ë³´ë‹¤, ë°°ê²½ìƒ‰ì´ ì„œì„œíˆ ë°ì•„ì§€ë‹¤ê°€ ë§ˆì§€ë§‰ì— ì§§ì€ ì°°ë‚˜ì˜ í™”ì´íŠ¸ í”Œë˜ì‹œê°€ í„°ì§€ë„ë¡ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.
 * í”¼íŒŒ ì¹´ë“œ ëŠë‚Œ: ê²°ê³¼ ì¹´ë“œì˜ ë°°ê²½ì— ì–´ë‘ìš´ ë„¤ì´ë¹„ ê·¸ë¼ë°ì´ì…˜ì„ ë„£ê³ , ì´ë¦„ í°íŠ¸ í¬ê¸°ë¥¼ ë” í‚¤ì›Œ 'ë ˆì „ë“œ ì„ ìˆ˜' ì¹´ë“œ ê°™ì€ ëŠë‚Œì„ ì¤¬ìŠµë‹ˆë‹¤.
ì´ì œ ì´ ì½”ë“œë¥¼ ë‹¤ì‹œ ê¹ƒí—ˆë¸Œì— ë„£ê³  ëŒë ¤ë³´ì„¸ìš”! í›¨ì”¬ ë” ì›…ì¥í•œ ëŠë‚Œì´ ë“¤ ê±°ì˜ˆìš”. ì™„ì„±ëœ í˜ì´ì§€ì—ì„œ í•œ ë²ˆ í…ŒìŠ¤íŠ¸í•´ë³´ì‹œê³ , ë§ˆì§€ë§‰ìœ¼ë¡œ ë” ìˆ˜ì •í•˜ê³  ì‹¶ì€ ë¶€ë¶„ì´ ìˆë‹¤ë©´ ë§ì”€í•´ ì£¼ì„¸ìš”!
